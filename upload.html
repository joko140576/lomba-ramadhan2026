<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Form Pendaftaran Lomba Ramadhan</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Font Awesome Icon -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(135deg, #0f9d58, #34a853);
    min-height: 100vh;
}

.banner-ramadhan {
    background: url('ssiku.png') center/cover no-repeat;
    height: 200px;
    border-radius: 15px 15px 0 0;
    position: relative;
}

.banner-overlay {
    background: rgba(0,0,0,0.4);
    height: 100%;
    border-radius: 15px 15px 0 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    text-align: center;
}

.form-container {
    background: white;
    border-radius: 15px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.25);
    overflow: hidden;
}

.form-content {
    padding: 40px;
}

.form-group-custom {
    margin-bottom: 25px;
}

.form-label {
    font-weight: 600;
}

.btn-custom {
    background: #0f9d58;
    color: white;
    font-weight: 600;
}

.btn-custom:hover {
    background: #0c7c45;
}

.required {
    color: red;
}

.upload-box {
    background: #ffffff;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    border: 1px solid #f1f1f1;
}

.upload-box:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 35px rgba(0,0,0,0.15);
}

.upload-icon {
    font-size: 28px;
    margin-right: 10px;
}

.upload-title {
    font-weight: 600;
    font-size: 18px;
}

.custom-input {
    border-radius: 10px;
}


<style>
.info-box {
    background: linear-gradient(135deg, #f8f9fa, #ffffff);
    border-radius: 18px;
    padding: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    border-left: 5px solid #198754;
}

.info-item {
    padding: 12px;
    border-radius: 12px;
    margin-bottom: 12px;
    font-size: 13px;   /* Ukuran text diperkecil */
}

.info-video {
    background: rgba(13,110,253,0.08);
    border-left: 4px solid #0d6efd;
}

.info-kaligrafi {
    background: rgba(25,135,84,0.08);
    border-left: 4px solid #198754;
}

.info-title {
    font-weight: 600;
    font-size: 14px;   /* Judul sedikit lebih besar dari isi */
}

.info-item p {
    margin-bottom: 0;
    font-size: 13px;
    line-height: 1.5;
}


</style>




</head>
<body>

<div class="container py-5">
<div class="row justify-content-center">
<div class="col-lg-7">

<div class="form-container">

<div class="banner-ramadhan">
<div class="banner-overlay">
<div>
<h2 class="fw-bold">Lomba Ramadhan 1447 H</h2>
<p class="mb-0">PT SSI - 2026</p>
</div>
</div>
</div>

<div class="container mt-4">
    <div class="info-box">

        <!-- Baris Pertama -->
        <div class="info-item info-video">
            <div class="d-flex align-items-start">
                <i class="fa-solid fa-video text-primary me-3 fs-4"></i>
                <div>
                    <div class="info-title text-primary">
                        Peserta Lomba Video, Mengaji & Azan
                    </div>
                    <p class="mb-0">
                        Untuk peserta lomba <b>Membuat Video Tema Ramadhan</b>, 
                        <b>Lomba Mengaji (Pegawai/Anak Pegawai)</b>, dan 
                        <b>Lomba Azan (Pegawai/Anak Pegawai)</b> 
                        <span class="text-danger fw-bold">WAJIB mengupload VIDEO (bukan foto)</span>.  
                        Ukuran video <b>480p</b> dengan besar file 
                        <b>&lt; 25 MB</b>.
                    </p>
                </div>
            </div>
        </div>

        <!-- Baris Kedua -->
        <div class="info-item info-kaligrafi">
            <div class="d-flex align-items-start">
                <i class="fa-solid fa-pen-nib text-success me-3 fs-4"></i>
                <div>
                    <div class="info-title text-success">
                        Peserta Lomba Kaligrafi
                    </div>
                    <p class="mb-0">
                        Untuk lomba <b>Kaligrafi</b>, 
                        <span class="text-danger fw-bold">tidak mengupload video</span>, 
                        tetapi cukup mengupload <b>2 foto</b>, yaitu:
                        <br>• Foto gambar kaligrafi
                        <br>• Foto anak pegawai yang sedang memegang gambar kaligrafinya
                    </p>
                </div>
            </div>
        </div>

    </div>
</div>


<div class="form-content">
<form id="formLomba">



<!-- Peserta -->
<div class="form-group-custom">
<label class="form-label">Pilihan Peserta <span class="required">*</span></label>
<select id="peserta" class="form-select" required>
<option value="">-- Pilih Peserta --</option>
<option value="Pegawai">Pegawai</option>
<option value="Anak Pegawai">Anak Pegawai</option>
</select>
</div>

<!-- Nama -->
<div class="form-group-custom">
<label class="form-label">Nama Partisipan <span class="required">*</span></label>
<input type="text" id="nama" class="form-control" required>
</div>

<!-- No WA -->
<div class="form-group-custom">
<label class="form-label">No. Telepon / WhatsApp <span class="required">*</span></label>
<input type="tel" id="noWa" class="form-control" pattern="[0-9]{10,15}" required>
<small class="text-muted">Hanya angka 10-15 digit</small>
</div>

<!-- Lomba -->
<div class="form-group-custom">
<label class="form-label">Lomba yang Diikuti <span class="required">*</span></label>
<select id="lomba" class="form-select" required>
<option value="">-- Pilih Lomba --</option>
<option value="video">Lomba Video Tema Ramadhan</option>
<option value="mengaji_pegawai">Lomba Mengaji (Pegawai)</option>
<option value="mengaji_anak">Lomba Mengaji (Anak Pegawai)</option>
<option value="azan_pegawai">Lomba Azan Pegawai</option>
<option value="azan_anak">Lomba Azan Anak Pegawai</option>
<option value="kaligrafi">Lomba Kaligrafi Anak Pegawai</option>
</select>
</div>

<div class="container mt-4">
    <div class="row g-4">

        <!-- Upload Video -->
        <div class="col-md-12">
            <div class="upload-box">
                <div class="d-flex align-items-center mb-3">
                    <i class="fa-solid fa-video upload-icon text-primary"></i>
                    <span class="upload-title">Upload Video</span>
                </div>

                <label class="form-label">Wajib kecuali lomba Kaligrafi</label>
                <input type="file" id="videoFile" class="form-control custom-input" accept="video/mp4">
                <small class="text-muted">
                    <i class="fa-solid fa-circle-info"></i> Format MP4 maksimal 100MB
                </small>
            </div>
        </div>

        <!-- Upload Kaligrafi -->
        <div class="col-md-12">
            <div class="upload-box">
                <div class="d-flex align-items-center mb-3">
                    <i class="fa-solid fa-pen-nib upload-icon text-success"></i>
                    <span class="upload-title">Upload Foto Kaligrafi</span>
                </div>

                <label class="form-label">Wajib untuk lomba Kaligrafi</label>
                <input type="file" id="foto1" class="form-control custom-input mb-2" accept="image/jpeg,image/png">
                <input type="file" id="foto2" class="form-control custom-input" accept="image/jpeg,image/png">
                <small class="text-muted">
                    <i class="fa-solid fa-image"></i> JPG/PNG maksimal 5MB per foto
                </small>
            </div>
        </div>

    </div>
</div>


<div class="d-grid mt-4">
<button type="submit" id="submitBtn" class="btn btn-custom btn-lg">
<span id="btnText">KIRIM / SUBMIT</span>
<span id="btnLoader" class="spinner-border spinner-border-sm ms-2 d-none"></span>
</button>
</div>

</form>
</div>
</div>

</div>
</div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbx6qHLMTVGLzmCmsG-yF8vJkH4MhKkAk0HZnLGV9EI9ZO2JIs4hDf6vj-Z2EGvyqhuw1g/exec";

const form = document.getElementById("formLomba");
const submitBtn = document.getElementById("submitBtn");
const btnText = document.getElementById("btnText");
const btnLoader = document.getElementById("btnLoader");

function validateFile(file, type, maxSizeMB){
    if(!file) return false;
    if(!file.type.includes(type)) return false;
    if(file.size > maxSizeMB * 1024 * 1024) return false;
    return true;
}

function toBase64(file){
    return new Promise((resolve)=>{
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result.split(',')[1]);
        reader.readAsDataURL(file);
    });
}

form.addEventListener("submit", async function(e){
e.preventDefault();

submitBtn.disabled = true;
btnLoader.classList.remove("d-none");
btnText.textContent = "Mengirim...";

try{

const peserta = document.getElementById("peserta").value;
const nama = document.getElementById("nama").value;
const noWa = document.getElementById("noWa").value;
const lomba = document.getElementById("lomba").value;

const video = document.getElementById("videoFile").files[0];
const foto1 = document.getElementById("foto1").files[0];
const foto2 = document.getElementById("foto2").files[0];

if(lomba === "kaligrafi"){
    if(!validateFile(foto1,"image",5) || !validateFile(foto2,"image",5)){
        alert("Upload 2 foto JPG/PNG maksimal 5MB");
        throw "Foto tidak valid";
    }
}else{
    if(!validateFile(video,"video",100)){
        alert("Upload video MP4 maksimal 100MB");
        throw "Video tidak valid";
    }
}

let videoBase64="", foto1Base64="", foto2Base64="";

if(video) videoBase64 = await toBase64(video);
if(foto1) foto1Base64 = await toBase64(foto1);
if(foto2) foto2Base64 = await toBase64(foto2);

const data = {
peserta, nama, noWa, lomba,
videoData: videoBase64,
foto1Data: foto1Base64,
foto2Data: foto2Base64,
videoName: video?.name || "",
foto1Name: foto1?.name || "",
foto2Name: foto2?.name || ""
};

const response = await fetch(scriptURL,{
method:"POST",
body:JSON.stringify(data)
});

const result = await response.json();

if(result.status === "success"){

    showModal(
        "success",
        "Pendaftaran Berhasil!",
        "Data Anda berhasil tersimpan. Terima kasih sudah berpartisipasi."
    );

    form.reset();

}else{

    showModal(
        "error",
        "Terjadi Kesalahan",
        "Data tidak dapat disimpan. Silakan coba kembali."
    );

}

}catch(err){

    console.error(err);

    showModal(
        "error",
        "Upload Gagal",
        "Gagal mengirim data. Periksa koneksi atau ukuran file Anda."
    );

}


submitBtn.disabled = false;
btnLoader.classList.add("d-none");
btnText.textContent = "KIRIM / SUBMIT";

});


function showModal(type, title, message){
    const modal = new bootstrap.Modal(document.getElementById('statusModal'));
    const icon = document.getElementById("modalIcon");
    const modalTitle = document.getElementById("modalTitle");
    const modalMessage = document.getElementById("modalMessage");

    if(type === "success"){
        icon.innerHTML = "✅";
        modalTitle.className = "fw-bold text-success";
    }else{
        icon.innerHTML = "❌";
        modalTitle.className = "fw-bold text-danger";
    }

    modalTitle.textContent = title;
    modalMessage.textContent = message;

    modal.show();
}

</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Modal Status -->
<div class="modal fade" id="statusModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-4">
      
      <div id="modalIcon" class="mb-3" style="font-size:60px;"></div>
      
      <h4 id="modalTitle" class="fw-bold"></h4>
      <p id="modalMessage" class="text-muted"></p>
      
      <div class="mt-3">
        <button type="button" class="btn btn-success px-4" data-bs-dismiss="modal">
          Tutup
        </button>
      </div>

    </div>
  </div>
</div>

</body>
</html>
