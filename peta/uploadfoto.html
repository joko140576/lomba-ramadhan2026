<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Pembacaan Alquran</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { background: #f7f7f7; padding: 50px; }
  .form-container { max-width: 600px; margin: auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
</style>
</head>
<body>
<div class="form-container">
  <h3 class="mb-4">Form Pembacaan Alquran</h3>
  <form id="alquranForm">
    <div class="mb-3">
      <label class="form-label">Nama Pegawai</label>
      <input type="text" class="form-control" id="nama" required>
    </div>
    <div class="mb-3">
      <label class="form-label">NPP</label>
      <input type="text" class="form-control" id="npp" required>
    </div>
    <div class="mb-3">
      <label class="form-label">COU</label>
      <select class="form-select" id="cou" required>
        <option value="">-- Pilih COU --</option>
        <option value="COU1">COU 1</option>
        <option value="COU2">COU 2</option>
        <option value="COU3">COU 3</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Upload Foto</label>
      <input type="file" class="form-control" id="foto" accept="image/*" required>
    </div>
    <button type="submit" class="btn btn-primary">Kirim</button>
  </form>
  <div id="status" class="mt-3"></div>
</div>

<script>
const form = document.getElementById("alquranForm");
const statusDiv = document.getElementById("status");
const GS_URL = "https://script.google.com/macros/s/AKfycbyrrYSpvA2azM8gOq9Skrm5a5XqcefqlTu3tcX-xLtjPMJGpaMxkMiCbikl2T-1LTBR/exec"; // ganti dengan Web App URL

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const nama = document.getElementById("nama").value;
  const npp = document.getElementById("npp").value;
  const cou = document.getElementById("cou").value;
  const fotoFile = document.getElementById("foto").files[0];

  if(!fotoFile){
    statusDiv.innerHTML = "<div class='alert alert-danger'>Silakan upload foto</div>";
    return;
  }

  const reader = new FileReader();
  reader.onload = async function() {
    const base64 = reader.result.split(",")[1]; // ambil base64
    const formData = new URLSearchParams();
    formData.append("nama", nama);
    formData.append("npp", npp);
    formData.append("cou", cou);
    formData.append("fotoBlob", base64);
    formData.append("fotoType", fotoFile.type);
    formData.append("fotoName", fotoFile.name);

    fetch(GS_URL, {
      method: "POST",
      body: formData
    })
    .then(res => res.json())
    .then(data => {
      if(data.status === "success"){
        statusDiv.innerHTML = "<div class='alert alert-success'>Data berhasil dikirim!</div>";
        form.reset();
      } else {
        statusDiv.innerHTML = `<div class='alert alert-danger'>Error: ${data.message}</div>`;
      }
    })
    .catch(err => {
      statusDiv.innerHTML = `<div class='alert alert-danger'>Error: ${err}</div>`;
    });
  };
  reader.readAsDataURL(fotoFile);
});
</script>
</body>
</html>
